<% @schemas.each do |key, schema| %>
    public static class <%= class_name(key) %> {
      <%- schema['properties'].each do |property_name, property| -%>
        private <%= type_for(class_name(key), property_name, property) -%> <%= property_name %>;
      <%- end -%>

      <%- if (schema['required'] || []).empty? -%>
        public <%= class_name(key) %>() {}
      <%- schema['properties'].each_with_index do |(property_name, property), index| -%>

        public static <%= class_name(key) %> from(<%= type_for(class_name(key), property_name, property) -%> <%= property_name %>) {
          <%= class_name(key) %> o = new <%= class_name(key) %>();
          <%- if property['items'] -%>
          o.<%= property_name %> = java.util.Collections.unmodifiableList(java.util.Objects.requireNonNull(<%= property_name %>, "<%= class_name(key) %>.<%= property_name %> cannot be null"));
          <%- else -%>
          o.<%= property_name %> = java.util.Objects.requireNonNull(<%= property_name %>, "<%= class_name(key) %>.<%= property_name %> cannot be null");
          <%- end -%>
          o.validate();
          return o;
        }
      <%- end -%>
      <%- else -%>
        private <%= class_name(key) %>() {}
      <%- end -%>

        public <%= class_name(key) %>(
        <%- schema['properties'].each_with_index do |(property_name, property), index| -%>
            <%= type_for(class_name(key), property_name, property) -%> <%= property_name %><%= index < schema['properties'].length-1 ? ',' : ''%>
        <%- end -%>
        ) {
          <%- schema['properties'].each_with_index do |(property_name, property), index| -%>
            <%- if property['items'] -%>
            this.<%= property_name %> = <%= property_name %> == null ? null : java.util.Collections.unmodifiableList(<%= property_name %>);
            <%- else -%>
            this.<%= property_name %> = <%= property_name %>;
            <%- end -%>
          <%- end -%>
            validate();
        }

      <%- schema['properties'].each do |property_name, property| -%>
        <%- if (schema['required'] || []).index(property_name) -%>

        public <%= type_for(class_name(key), property_name, property) -%> get<%= capitalize(property_name) %>() {
            return <%= property_name %>;
        }
        <%- else -%>

        public java.util.Optional<<%= type_for(class_name(key), property_name, property) -%>> get<%= capitalize(property_name) %>() {
            return java.util.Optional.ofNullable(<%= property_name %>);
        }
        <%- end -%>
      <%- end -%>

        private void validate() {
        <%- schema['properties'].each do |property_name, property|
          required = (schema['required'] || []).index(property_name)
        -%>
          <%- if required -%>
            java.util.Objects.requireNonNull(<%= property_name -%>, "<%= class_name(key) %>.<%= property_name %> cannot be null");
          <%- end -%>
          <%- if property['type'] == 'array' -%>
            <%- if property['items']['type'] -%>
            <% if !required %>if (<%= property_name %> != null) <%- end %><%= property_name %>.forEach(e -> java.util.Objects.requireNonNull(e, "<%= class_name(key) %>.<%= property_name %> elements cannot be null"));
            <%- else -%>
            <% if !required %>if (<%= property_name %> != null) <%- end %><%= property_name %>.forEach(<%= type_for(key, nil, property['items']) %>::validate);
            <%- end -%>
          <%- elsif property['$ref'] -%>
            <% if !required %>if (<%= property_name %> != null) <%- end %><%= property_name %>.validate();
          <%- end -%>
        <%- end -%>
        }

        @Override
        public boolean equals(Object o) {
            if (this == o) return true;
            if (o == null || getClass() != o.getClass()) return false;
            <%= class_name(key) %> that = (<%= class_name(key) %>) o;
            return <%- schema['properties'].each_with_index do |(property_name, property), index| %>
                <%- if (schema['required'] || []).index(property_name) -%>
                <%= property_name -%>.equals(that.<%= property_name -%>)<%= index < schema['properties'].length-1 ? ' && ' : ';' -%>
                <%- else -%>
                java.util.Objects.equals(<%= property_name -%>, that.<%= property_name -%>)<%= index < schema['properties'].length-1 ? ' && ' : ';' -%>
                <%- end -%>
            <% end -%>

        }

        @Override
        public int hashCode() {
            return java.util.Objects.hash(
            <%- schema['properties'].each_with_index do |(property_name, property), index| -%>
                <%= property_name %><%= index < schema['properties'].length-1 ? ',' : ''%>
            <%- end -%>
            );
        }

        @Override
        public String toString() {
            return "<%= class_name(key) %>{" +
            <%- schema['properties'].each_with_index do |(property_name, property), index| -%>
                "<%= index == 0 ? '' : ', '%><%= property_name %>=" + <%= property_name %> +
            <%- end -%>
                '}';
        }
    }

<% end -%>
