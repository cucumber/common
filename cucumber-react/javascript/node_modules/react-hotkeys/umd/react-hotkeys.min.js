/**
 * ISC License
 *
 * Copyright (c) 2018, Aleck Greenham
 *
 * Permission to use, copy, modify, and/or distribute this software for any purpose with or without fee is hereby granted, provided that the above copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * PLEASE NOTE: SOURCE CODE FOUND IN THE lib/vendor DIRECTORY IS UNDER THE MIT LICENSE - PLEASE SEE THE LICENSE FILE FOR EACH DIRECTORY FOR MORE INFORMATION
 */

!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("prop-types"),require("react")):"function"==typeof define&&define.amd?define(["exports","prop-types","react"],t):t((e=e||self).ReactHotkeys={},e.PropTypes,e.React)}(this,function(e,a,u){"use strict";a=a&&a.hasOwnProperty("default")?a.default:a;var c="default"in u?u.default:u;function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function h(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}function _(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function y(){return(y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}function b(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(e){_(t,e,n[e])})}return t}function p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function i(e,t,n){return(i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()?Reflect.construct:function(e,t,n){var o=[null];o.push.apply(o,t);var i=new(Function.bind.apply(e,o));return n&&r(i,n.prototype),i}).apply(null,arguments)}function n(e){var o="function"==typeof Map?new Map:void 0;return(n=function(e){if(null===e||(t=e,-1===Function.toString.call(t).indexOf("[native code]")))return e;var t;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==o){if(o.has(e))return o.get(e);o.set(e,n)}function n(){return i(e,arguments,d(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),r(n,e)})(e)}function v(e,t){if(null==e)return{};var n,o,i=function(e,t){if(null==e)return{};var n,o,i={},r=Object.keys(e);for(o=0;o<r.length;o++)n=r[o],0<=t.indexOf(n)||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)n=r[o],0<=t.indexOf(n)||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function g(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?f(e):t}function s(e,t,n){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=d(e)););return e}(e,t);if(o){var i=Object.getOwnPropertyDescriptor(o,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function k(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],o=!0,i=!1,r=void 0;try{for(var s,a=e[Symbol.iterator]();!(o=(s=a.next()).done)&&(n.push(s.value),!t||n.length!==t);o=!0);}catch(e){i=!0,r=e}finally{try{o||null==a.return||a.return()}finally{if(i)throw r}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function m(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function E(e){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;return e.reduce(function(e,t){return e[t]=n||{value:t},e},{})}var K={logLevel:"warn",defaultKeyEvent:"keydown",defaultComponent:"div",defaultTabIndex:"-1",ignoreTags:["input","select","textarea"],enableHardSequences:!1,ignoreKeymapAndHandlerChangesByDefault:!0,ignoreEventsCondition:function(e){var t=e.target;if(t&&t.tagName){var n=t.tagName.toLowerCase();return I.option("_ignoreTagsDict")[n]||t.isContentEditable}return!1},simulateMissingKeyPressEvents:!0,stopEventPropagationAfterHandling:!0,stopEventPropagationAfterIgnoring:!0},C=b({},K);C._ignoreTagsDict=E(C.ignoreTags,!0);var I=function(){function e(){l(this,e)}return h(e,null,[{key:"init",value:function(t){var n=this;t.ignoreTags&&(t._ignoreTagsDict=E(t.ignoreTags)),-1!==["verbose","debug","info"].indexOf(t.logLevel)&&console.warn("React HotKeys: You have requested log level '".concat(t.logLevel,"' but for performance reasons, logging below severity level 'warning' is disabled in production. Please use the development build for complete logs.")),Object.keys(t).forEach(function(e){n.set(e,t[e])})}},{key:"set",value:function(e,t){C[e]=t}},{key:"reset",value:function(e){C[e]=K[e]}},{key:"option",value:function(e){return C[e]}}]),e}(),S=function(){function n(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"warn";l(this,n),_(this,"verbose",this.noop),_(this,"debug",this.noop),_(this,"info",this.noop),_(this,"warn",this.noop),_(this,"error",this.noop),this.logLevel=this.constructor.levels[e],this.logLevel>=this.constructor.levels.error&&(this.error=console.error,this.logLevel>=this.constructor.levels.warn&&(this.warn=console.warn,["info","debug","verbose"].some(function(e){return!(t.logLevel>=t.constructor.levels[e])||(t[e]=console.log,!1)})))}return h(n,[{key:"noop",value:function(){}}]),n}();function w(e){return void 0===e}_(S,"logIcons",["üìï","üìó","üìò","üìô"]),_(S,"componentIcons",["üî∫","‚≠êÔ∏è","üî∑","üî∂","‚¨õÔ∏è"]),_(S,"eventIcons",["‚ù§Ô∏è","üíö","üíô","üíõ","üíú","üß°"]),_(S,"levels",{none:0,error:1,warn:2,info:3,debug:4,verbose:5});var P=function(){function e(){l(this,e)}return h(e,null,[{key:"newBitmap",value:function(e){var t=[!1,!1,!1];if(!w(e))for(var n=0;n<=e;n++)t[n]=!0;return t}},{key:"setBit",value:function(e,t){return e[t]=!0,e}},{key:"clone",value:function(e){for(var t=this.newBitmap(),n=0;n<e.length;n++)t[n]=e[n];return t}},{key:"and",value:function(e,t){for(var n=[],o=0;o<e.length;o++)n[o]=e[o]&t[o];return n}}]),e}(),O={keydown:0,keypress:1,keyup:2},M={"`":["~"],1:["!"],2:["@",'"'],3:["#","¬£"],4:["$"],5:["%"],6:["^"],7:["&"],8:["*"],9:["("],0:[")"],"-":["_"],"=":["plus"],";":[":"],"'":['"',"@"],",":["<"],".":[">"],"/":["?"],"\\":["|"],"[":["{"],"]":["}"],"#":["~"]};function H(e){return M[e]||[1===e.length?e.toUpperCase():e]}function T(e,t){return e.hasOwnProperty(t)}function A(e){return Object.keys(e).reduce(function(t,n){return e[n].forEach(function(e){T(t,e)||(t[e]=[]),t[e].push(n)}),t},{})}var x=A(M);function D(e){return x[e]||[1===e.length?e.toLowerCase():e]}var B={Backspace:["Delete"]};function L(e){return"string"==typeof e}var j={tab:"Tab",capslock:"CapsLock",shift:"Shift",meta:"Meta",alt:"Alt",ctrl:"Control",space:" ",spacebar:" ",escape:"Escape",esc:"Escape",left:"ArrowLeft",right:"ArrowRight",up:"ArrowUp",down:"ArrowDown",return:"Enter",del:"Backspace",command:"Meta",option:"Alt",enter:"Enter",backspace:"Backspace",ins:"Insert",pageup:"PageUp",pagedown:"PageDown",end:"End",home:"Home",contextmenu:"ContextMenu",numlock:"Clear"},F={cmd:"Meta"};function q(e){var t=e.toLowerCase();return j[t]||F[t]||(e.match(/^f\d+$/)?e.toUpperCase():e)}var R={Shift:!0,Control:!0,Alt:!0,Meta:!0,Enter:!0,Tab:!0,CapsLock:!0,BackSpace:!0,Escape:!0};function U(e){return!!R[e]||String.fromCharCode(e.charCodeAt(0))===e}var N=function(e){function t(){return l(this,t),g(this,d(t).apply(this,arguments))}return p(t,n(Error)),t}();function G(e){return e.sort().join("+")}var z=function(){function e(){l(this,e)}return h(e,null,[{key:"parse",value:function(e){var t,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},o=(L(t=e)?t.trim().replace(/\s+/g," "):t).split(" ");try{var i=o.slice(0,o.length-1),r=o[o.length-1],s=i.map(function(e){var t=W(e,n);return G(Object.keys(t))}).join(" "),a=W(r,n),u={id:G(Object.keys(a)),keyDictionary:a,eventBitmapIndex:n.eventBitmapIndex,size:Object.keys(a).length};return{sequence:{prefix:s,size:i.length+1},combination:u}}catch(e){return{sequence:null,combination:null}}}}]),e}();function W(e){var o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return e.replace(/^\+|(\s|[^+]\+)\+/,"$1plus").split("+").reduce(function(e,t){var n=q(t);if(o.ensureValidKeys&&!U(n))throw new N;return e[n]=!0,e},{})}var V={"`":["`"],1:["¬°"],2:["‚Ñ¢"],3:["¬£"],4:["¬¢"],5:["‚àû"],6:["¬ß"],7:["¬∂"],8:["‚Ä¢"],9:["¬™"],0:["¬∫"],"-":["‚Äì"],"=":["‚â†"],a:["√•"],b:["‚à´"],c:["√ß"],d:["‚àÇ"],e:["¬¥"],f:["∆í"],g:["¬©"],h:["Àô"],i:["ÀÜ"],j:["‚àÜ"],k:["Àö"],l:["¬¨"],m:["¬µ"],n:["Àú"],o:["√∏"],p:["œÄ"],q:["≈ì"],r:["¬Æ"],s:["√ü"],t:["‚Ä†"],u:["¬®"],v:["‚àö"],w:["‚àë"],x:["‚âà"],y:["¬•"],z:["Œ©"],"[":["‚Äú"],"]":["‚Äò"],"\\":["¬´"],"'":["√¶"],";":["‚Ä¶"],",":["‚â§"],".":["‚â•"],"/":["√∑"]},$=A(V);function Y(e){return $[e]||[e]}function J(e){return V[e]||[e]}var Q={"`":["`"],1:["‚ÅÑ"],2:["‚Ç¨"],3:["‚Äπ"],4:["‚Ä∫"],5:["Ô¨Å"],6:["Ô¨Ç"],7:["‚Ä°"],8:["¬∞"],9:["¬∑"],0:["‚Äö"],"-":["‚Äî"],"=":["¬±"],a:["√Ö"],b:["ƒ±"],c:["√á"],d:["√é"],e:["¬¥"],f:["√è"],g:["Àù"],h:["√ì"],i:["ÀÜ"],j:["√î"],k:["Ô£ø"],l:["√í"],m:["√Ç"],n:["Àú"],o:["√ò"],p:["œÄ"],q:["≈í"],r:["‚Ä∞"],s:["√ç"],t:["√é"],u:["¬®"],v:["‚óä"],w:["‚Äû"],x:["Àõ"],y:["√Å"],z:["¬∏"],"[":["‚Äù"],"]":["‚Äô"],"\\":["¬ª"],"'":["√Ü"],";":["√ö"],",":["¬Ø"],".":["Àò"]},X=A(Q);function Z(e){return X[e]||D(e)}function ee(e){return Q[e]||[e]}var te=function(){function e(){l(this,e)}return h(e,null,[{key:"serialize",value:function(e){var l=e.Shift,h=e.Alt,y={};return Object.keys(e).sort().forEach(function(e){var n=[];if(l)if(h){var t=Z(e),o=ee(e);n=[].concat(m(n),[e],m(t),m(o))}else{var i=D(e),r=H(e);n=[].concat(m(n),[e],m(i),m(r))}else if(h){var s=Y(e),a=J(e);n=[].concat(m(n),[e],m(s),m(a))}else{n.push(e);var u=B[e];u&&(n=[].concat(m(n),m(u)))}var c=Object.keys(y);0<c.length?c.forEach(function(t){n.forEach(function(e){y[t+"+".concat(e)]=b({},y[t],_({},e,!0))}),delete y[t]}):n.forEach(function(e){y[e]=_({},e,!0)})}),Object.values(y).map(function(e){return Object.keys(e).sort().join("+")})}},{key:"isValidKeySerialization",value:function(e){return 0<e.length&&!!z.parse(e,{ensureValidKeys:!0}).combination}}]),e}();function ne(e){return Array.isArray(e)?e:e?[e]:[]}function oe(e,t){return e[e.length-(t+1)]}function ie(e){return!Array.isArray(e)&&"object"===t(e)&&null!==e}function re(e){return ie(e)?0===Object.keys(e).length:!e||0===e.length}function se(e){switch(parseInt(e,10)){case 0:return"keydown";case 1:return"keypress";default:return"keyup"}}var ae=0,ue=1;var ce={Shift:["shiftKey"],Meta:["metaKey"],Control:["ctrlKey"],Alt:["altKey"]};for(var le={Shift:!0,Control:!0,Alt:!0,Meta:!0,Enter:!0,Tab:!0,BackSpace:!0,ArrowRight:!0,ArrowLeft:!0,ArrowUp:!0,ArrowDown:!0,CapsLock:!0},he=1;he<13;he++)le["F".concat(he)]=!0;var ye=function(){function n(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=1<arguments.length?arguments[1]:void 0;l(this,n),this.logger=e.logger||new S("warn"),this.componentId=-1,this.keyEventManager=t,this.keyMapRegistry={},this.componentRegistry={},this.rootComponentId=null,this._reset(),this._resetKeyCombinationHistory()}return h(n,[{key:"_reset",value:function(){this._initRegisteredKeyMapsState(),this._initHandlerResolutionState()}},{key:"_initRegisteredKeyMapsState",value:function(){this.componentList=[],this.longestSequence=1,this.longestSequenceComponentIndex=null,this.keyMapEventBitmap=P.newBitmap(),this.componentIdDict={}}},{key:"_initHandlerResolutionState",value:function(){this.keyMaps=null,this.handlerResolutionSearchIndex=0,this.unmatchedHandlerStatus=null,this.handlersDictionary={},this.keySequencesDictionary={}}},{key:"_resetKeyCombinationHistory",value:function(){if(this.keyCombinationIncludesKeyUp=!1,this.keypressEventsToSimulate=[],this.keyupEventsToSimulate=[],!this.keyCombinationHistory||this.keyCombinationHistory.length<1)this.keyCombinationHistory=[];else{var i=this._getCurrentKeyCombination(),e=Object.keys(i.keys).reduce(function(e,t){var n=i.keys[t],o=n[ue];return o[O.keydown]&&!o[O.keyup]&&(e[t]=n),e},{});this.keyCombinationHistory=[{keys:e,ids:te.serialize(e)}]}}},{key:"getApplicationKeyMap",value:function(){return null===this.rootComponentId?{}:this._buildApplicationKeyMap([this.rootComponentId],{})}},{key:"_buildApplicationKeyMap",value:function(e,i){var n=this;return e.forEach(function(e){var t=n.componentRegistry[e],o=n.keyMapRegistry[e];o&&Object.keys(o).forEach(function(n){i[n]=[],ne(o[n]).forEach(function(e){var t=ie(e)?e.sequence:e;i[n].push(t)})}),n._buildApplicationKeyMap(t.childIds,i)}),i}},{key:"registerKeyMap",value:function(e){return this.componentId+=1,this.keyMapRegistry[this.componentId]=e,this.componentRegistry[this.componentId]={childIds:[],parentId:null},this.componentId}},{key:"reregisterKeyMap",value:function(e,t){this.keyMapRegistry[e]=t}},{key:"registerComponentMount",value:function(e,t){w(t)?this.rootComponentId=e:(this.componentRegistry[e].parentId=t,this.componentRegistry[t].childIds.push(e))}},{key:"deregisterKeyMap",value:function(e){var t=this.componentRegistry[e].parentId,n=this.componentRegistry[t];n&&(n.childIds=function(n){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},i=E(ne(e));return Array.isArray(n)?n.reduce(function(e,t){return i[t]&&(o.stringifyFirst||i[t].value===t)||e.push(t),e},[]):ie(n)?Object.keys(n).reduce(function(e,t){return i[t]||(e[t]=n[t]),e},{}):n}(n.childIds,e)),delete this.componentRegistry[e],delete this.keyMapRegistry[e],e===this.rootComponentId&&(this.rootComponentId=null)}},{key:"_addComponentToList",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},o=3<arguments.length?arguments[3]:void 0,i=this._buildComponentOptions(e,t,n,o);this.componentList.push(i),this._setComponentPosition(e,this.componentList.length-1)}},{key:"_buildComponentOptions",value:function(e,t,n,o){var i=this._applyHardSequences(t,n),r=i.keyMap,s=i.handlers;return{actions:this._buildActionDictionary(b({},t,r),o,e),handlers:s,componentId:e,options:o}}},{key:"_applyHardSequences",value:function(n,o){return I.option("enableHardSequences")?Object.keys(o).reduce(function(e,t){return!!!n[t]&&te.isValidKeySerialization(t)&&(e.keyMap[t]=t),e.handlers[t]=o[t],e},{keyMap:{},handlers:{}}):{keyMap:n,handlers:o}}},{key:"_buildActionDictionary",value:function(e,c,l){var h=this;return Object.keys(e).reduce(function(a,u){return ne(e[u]).forEach(function(n){var e=function(){if(ie(n)){var e=n.sequence,t=n.action;return{keySequence:e,eventBitmapIndex:w(t)?O[c.defaultKeyEvent]:O[t]}}return{keySequence:n,eventBitmapIndex:O[c.defaultKeyEvent]}}(),t=e.keySequence,o=e.eventBitmapIndex,i=z.parse(t,{eventBitmapIndex:o}),r=i.sequence,s=i.combination;r.size>h.longestSequence&&(h.longestSequence=r.size,h.longestSequenceComponentIndex=l),P.setBit(h.keyMapEventBitmap,o),a[u]||(a[u]=[]),a[u].push(b({prefix:r.prefix,actionName:u,sequenceLength:r.size},s))}),a},{})}},{key:"_getCurrentKeyCombination",value:function(){return 0<this.keyCombinationHistory.length?this.keyCombinationHistory[this.keyCombinationHistory.length-1]:{keys:{},ids:[""],keyAliases:{}}}},{key:"_addToCurrentKeyCombination",value:function(e,t){0===this.keyCombinationHistory.length&&this.keyCombinationHistory.push({keys:{},ids:[""],keyAliases:{}});var n=this._getCurrentKeyCombination(),o=de(n,e),i=ve(n,e);n.keys[o]=i?[P.clone(i[1]),P.newBitmap(t)]:[P.newBitmap(),P.newBitmap(t)],n.ids=te.serialize(n.keys),n.keyAliases=this._buildCombinationKeyAliases(n.keys),t===O.keyup&&(this.keyCombinationIncludesKeyUp=!0)}},{key:"_startNewKeyCombination",value:function(e,t){this.keyCombinationHistory.length>this.longestSequence&&this.keyCombinationHistory.shift();var n=this._getCurrentKeyCombination(),o=b({},this._withoutKeyUps(n),_({},e,[P.newBitmap(),P.newBitmap(t)]));this.keyCombinationHistory.push({keys:o,ids:te.serialize(o),keyAliases:this._buildCombinationKeyAliases(o)}),this.keyCombinationIncludesKeyUp=!1}},{key:"_withoutKeyUps",value:function(o){return Object.keys(o.keys).reduce(function(e,t){var n=o.keys[t];return n[ue][O.keyup]||(e[t]=n),e},{})}},{key:"_shouldSimulate",value:function(e,t){var n=!le[t];return e===O.keypress?!n||n&&this._keyIsCurrentlyDown("Meta"):e===O.keyup&&(n&&pe(this._getCurrentKeyState("Meta"),O.keyup))}},{key:"_cloneAndMergeEvent",value:function(n,e){return b({},Object.keys(ce).reduce(function(e,t){return e[t]=n[t],e},{}),e)}},{key:"_callMatchingHandlerClosestToEventTarget",value:function(e,t,n,o,i){var p=this;for(this.keyMaps&&this.unmatchedHandlerStatus||(this.keyMaps=[],this.unmatchedHandlerStatus=[],this.componentList.forEach(function(e){var t=e.handlers;p.unmatchedHandlerStatus.push([Object.keys(t).length,{}]),p.keyMaps.push({})}));i<=o;){var r=this.unmatchedHandlerStatus[i][0];if(0<r)for(var s=function(){var e=p.componentList[p.handlerResolutionSearchIndex],t=e.handlers,o=e.actions;Object.keys(t).forEach(function(e){p.handlersDictionary[e]||(p.handlersDictionary[e]=[]),p.handlersDictionary[e].push(p.handlerResolutionSearchIndex)}),Object.keys(o).forEach(function(n){var e=p.handlersDictionary[n];if(e){var l=e[0],h=p.componentList[l].handlers[n],y=p.keyMaps[l];y.sequences||(y.sequences={}),o[n].forEach(function(t){var e=[t.prefix,t.id].join(" ");if(!(p.keySequencesDictionary[e]&&p.keySequencesDictionary[e].some(function(e){return e[1]===t.eventBitmapIndex}))){y.sequences[t.prefix]||(y.sequences[t.prefix]={combinations:{}});var n=t.prefix,o=t.sequenceLength,i=t.id,r=t.keyDictionary,s=t.size,a=t.eventBitmapIndex,u=t.actionName,c=y.sequences[t.prefix].combinations[t.id];y.sequences[t.prefix].combinations[t.id]=c?b({},c,{events:b({},c.events,_({},a,{actionName:u,eventBitmapIndex:a,handler:h}))}):{prefix:n,sequenceLength:o,id:i,keyDictionary:r,size:s,events:_({},a,{actionName:u,eventBitmapIndex:a,handler:h})},y.eventBitmap||(y.eventBitmap=P.newBitmap()),P.setBit(y.eventBitmap,t.eventBitmapIndex),(!y.longestSequence||y.longestSequence<t.sequenceLength)&&(y.longestSequence=t.sequenceLength),p.keySequencesDictionary[e]||(p.keySequencesDictionary[e]=[]),p.keySequencesDictionary[e].push([l,t.eventBitmapIndex])}}),e.forEach(function(e){var t=p.unmatchedHandlerStatus[e];t[1][n]||(t[1][n]=!0,t[0]--)})}}),p.handlerResolutionSearchIndex++};this.handlerResolutionSearchIndex<this.componentList.length&&0<r;)s();var a=this.keyMaps[i];if(a&&!re(a.sequences)&&a.eventBitmap[n])for(var u=a.sequences,c=a.longestSequence,l=this._getCurrentKeyCombination(),h=de(l,t),y=c;0<=y;){var d=this.keyCombinationHistory.slice(-y,-1).map(function(e){return e.ids}),v=this._tryMatchSequenceWithKeyAliases(u,d);if(v){v.order||function(){var n=Object.values(v.combinations).reduce(function(e,t){var n=t.id,o=t.size;return e[o]||(e[o]=[]),e[o].push(n),e},{});v.order=Object.keys(n).sort(function(e,t){return t-e}).reduce(function(e,t){return e.concat(n[t])},[])}();for(var f=v.order,g=0;g<f.length;){var k=f[g],m=v.combinations[k];if(this._combinationMatchesKeys(h,l,m,n)){te.serialize(m.keyDictionary);return m.events[n].handler(e),this._stopEventPropagationAfterHandlingIfEnabled(e,i),!0}g++}}y--}else;i++}}},{key:"_stopEventPropagationAfterHandlingIfEnabled",value:function(e,t){return!!I.option("stopEventPropagationAfterHandling")&&(this._stopEventPropagation(e,t),!0)}},{key:"_stopEventPropagationAfterIgnoringIfEnabled",value:function(e,t){return!!I.option("stopEventPropagationAfterIgnoring")&&(this._stopEventPropagation(e,t),!0)}},{key:"_describeCurrentKeyCombination",value:function(){return this._getCurrentKeyCombination().ids[0]}},{key:"_tryMatchSequenceWithKeyAliases",value:function(e,n){if(0===n.length)return e[""];for(var t=n.map(function(e){return e.length}),o=n.map(function(){return 0}),i=!1;!i;){var r=o.map(function(e,t){return n[t][e]}).join(" ");if(e[r])return e[r];for(var s=0,a=!0;a&&s<o.length;){var u=(oe(o,s)+1)%(oe(t,s)||1);(a=0===(o[o.length-(s+1)]=u))&&s++}i=s===o.length}}},{key:"_combinationMatchesKeys",value:function(i,r,e,s){if(!e.events[s])return!1;var a=!1;return!Object.keys(e.keyDictionary).some(function(e){var t,n,o=ve(r,e);return!o||(!pe(o,s)||(i&&i===de(r,e)&&(n=s,a=!((t=o)&&t[ae][n])),!1))})&&a}},{key:"_checkForModifierFlagDiscrepancies",value:function(o){var i=this;Object.keys(ce).forEach(function(t){var n=i._keyIsCurrentlyDown(t);ce[t].forEach(function(e){!1===o[e]&&n&&i._addToCurrentKeyCombination(t,O.keyup)})})}},{key:"_keyIsCurrentlyDown",value:function(e){var t=this._getCurrentKeyState(e);return!!(pe(t,O.keypress)&&!pe(t,O.keyup))}},{key:"_getCurrentKeyState",value:function(e){return ve(this._getCurrentKeyCombination(),e)}},{key:"_buildCombinationKeyAliases",value:function(t){var i=function(){if(t.Shift)return t.Alt?[ee,Z]:[H,D];if(t.Alt)return[J,Y];var e=function(e){return[e]};return[e,e]}();return Object.keys(t).reduce(function(n,o){var e;return(e=o,B[e]||[e]).forEach(function(t){i.forEach(function(e){e(t).forEach(function(e){e===o&&o===t||(n[e]=o)})})}),n},{})}},{key:"_setComponentPosition",value:function(e,t){this.componentIdDict[e]=t}},{key:"_getComponentPosition",value:function(e){return this.componentIdDict[e]}},{key:"_getComponent",value:function(e){var t=this._getComponentPosition(e);return this.componentList[t]}},{key:"_getComponentAndPosition",value:function(e){var t=this._getComponentPosition(e);return[this.componentList[t],t]}},{key:"_logPrefix",value:function(){}}]),n}();function pe(e,t){return e&&e[ue][t]}function de(e,t){if(e.keys[t])return t;var n=e.keyAliases[t];return n||t}function ve(e,t){var n=e.keys[t];if(n)return n;var o=e.keyAliases[t];return o?e.keys[o]:void 0}var fe=function(){function e(){l(this,e)}return h(e,null,[{key:"getId",value:function(){return w(this.id)&&(this.id=0),this.id}},{key:"incrementId",value:function(){this.id=this.getId()+1}}]),e}();function ge(e){return"+"===e?"plus":e}function ke(e){return"Meta"===e}var me=0,_e=1,be=2,Ee=4,Ke=function(e){function o(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=1<arguments.length?arguments[1]:void 0;return l(this,o),(e=g(this,d(o).call(this,t,n))).focusTreeId=0,e.currentEvent={key:null,type:null,handled:!1,ignored:!1},e}return p(o,ye),h(o,[{key:"_reset",value:function(){s(d(o.prototype),"_reset",this).call(this),this.keypressEventsToSimulate=[],this.focusTreeId+=1,this._clearEventPropagationState()}},{key:"_clearEventPropagationState",value:function(){this.eventPropagationState={previousComponentPosition:-1,actionHandled:!1,ignoreEvent:!1,forceObserveEvent:!1,stopping:!1}}},{key:"enableHotKeys",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},o=3<arguments.length?arguments[3]:void 0;(this.resetOnNextFocus||this.keyMaps)&&(this._reset(),this.resetOnNextFocus=!1),this._addComponentToList(e,t,n,o);this._getComponent(e);return this.focusTreeId}},{key:"updateEnabledHotKeys",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{},i=4<arguments.length?arguments[4]:void 0,r=this._getComponentPosition(t);if(e===this.focusTreeId&&!w(r)){this.componentList[r]=this._buildComponentOptions(t,n,o,i);this._getComponent(t)}}},{key:"disableHotKeys",value:function(e,t){this.resetOnNextFocus||(this.resetOnNextFocus=!0);var n=this._getComponentPosition(t),o=this.eventPropagationState.previousComponentPosition;return-1!==o&&o+1<n}},{key:"handleKeydown",value:function(e,t,n){var o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{},i=ge(e.key);if(t!==this.focusTreeId)return this._ignoreEvent(e,n),!0;this._howToHandleKeyDownEvent(e,t,n,i,o,O.keydown)===Ee&&(!!this._getCurrentKeyState(i)||this.keyCombinationIncludesKeyUp?this._startAndLogNewKeyCombination(i,O.keydown,t,n):this._addToAndLogCurrentKeyCombination(i,O.keydown,t,n),this._callHandlerIfActionNotHandled(e,i,O.keydown,n,t));return this._simulateKeyPressesMissingFromBrowser(e,i,t,n,o),this._updateEventPropagationHistory(n),!1}},{key:"_howToHandleKeyDownEvent",value:function(e,t,n,o,i,r){if(this._shouldIgnoreEvent())return this._ignoreEvent(e,n),_e;if(this._isNewKeyEvent(n)){if(this._setNewEventParameters(e,r),this._setIgnoreEventFlag(e,i),this._shouldIgnoreEvent())return this._ignoreEvent(e,n),_e;this._checkForModifierFlagDiscrepancies(e)}return Ee}},{key:"handleKeypress",value:function(e,t,n,o){var i=ge(e.key),r=t!==this.focusTreeId,s=this._howToHandleKeyDownEvent(e,t,n,i,o,O.keypress);return this._isNewKeyEvent(n)&&this._getCurrentKeyState(i)&&this._addToAndLogCurrentKeyCombination(i,O.keypress,t,n),s===Ee&&this._callHandlerIfActionNotHandled(e,i,O.keypress,n,t),this._updateEventPropagationHistory(n),r}},{key:"handleKeyup",value:function(e,t,n,o){var i=ge(e.key),r=t!==this.focusTreeId,s=this._howToHandleKeyDownEvent(e,t,n,i,o,O.keyup);return this._isNewKeyEvent(n)&&this._getCurrentKeyState(i)&&this._addToAndLogCurrentKeyCombination(i,O.keyup,t,n),s===Ee&&this._callHandlerIfActionNotHandled(e,i,O.keyup,n,t),this._simulateKeyUpEventsHiddenByCmd(e,i,t,n,o),this._updateEventPropagationHistory(n),r}},{key:"_simulateKeyPressesMissingFromBrowser",value:function(e,t,n,o,i){this._handleEventSimulation("keypressEventsToSimulate","simulatePendingKeyPressEvents",this._shouldSimulate(O.keypress,t),{event:e,key:t,focusTreeId:n,componentId:o,options:i})}},{key:"_simulateKeyUpEventsHiddenByCmd",value:function(t,e,n,o,i){var r=this;ke(e)&&Object.keys(this._getCurrentKeyCombination().keys).forEach(function(e){ke(e)||r._handleEventSimulation("keyupEventsToSimulate","simulatePendingKeyUpEvents",r._shouldSimulate(O.keyup,e),{event:t,key:e,focusTreeId:n,componentId:o,options:i})})}},{key:"_ignoreEvent",value:function(e,t){this.currentEvent.ignored=!0,this._stopEventPropagationAfterIgnoringIfEnabled(e,t)?this._updateEventPropagationHistory(t,{forceReset:!0}):this._updateEventPropagationHistory(t)}},{key:"_shouldIgnoreEvent",value:function(){var e=this.eventPropagationState,t=e.ignoreEvent;return!e.forceObserveEvent&&t}},{key:"_isNewKeyEvent",value:function(e){var t=this.eventPropagationState.previousComponentPosition;return-1===t||t>=this._getComponentPosition(e)}},{key:"_updateEventPropagationHistory",value:function(e){(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{forceReset:!1}).forceReset||this._isFocusTreeRoot(e)?this._clearEventPropagationState():this.eventPropagationState.previousComponentPosition=this._getComponentPosition(e)}},{key:"_setIgnoreEventFlag",value:function(e,t){this.eventPropagationState.ignoreEvent=t.ignoreEventsCondition(e)}},{key:"ignoreEvent",value:function(){this.eventPropagationState.ignoreEvent=!0}},{key:"forceObserveEvent",value:function(){this.eventPropagationState.forceObserveEvent=!0}},{key:"_isFocusTreeRoot",value:function(e){return this._getComponentPosition(e)>=this.componentList.length-1}},{key:"_setNewEventParameters",value:function(e,t){fe.incrementId(),this.currentEvent={key:e.key,type:t,handled:!1,ignored:!1}}},{key:"_startAndLogNewKeyCombination",value:function(e,t,n,o){this._startNewKeyCombination(e,t)}},{key:"_addToAndLogCurrentKeyCombination",value:function(e,t,n,o){this._addToCurrentKeyCombination(e,t)}},{key:"_stopEventPropagation",value:function(e,t){this.eventPropagationState.stopping||(this.eventPropagationState.stopping=!0,e.simulated||e.stopPropagation())}},{key:"_handleEventSimulation",value:function(e,t,n,o){var i=o.event,r=o.key,s=o.focusTreeId,a=o.componentId,u=o.options;if(n&&I.option("simulateMissingKeyPressEvents")){var c=this._cloneAndMergeEvent(i,{key:r,simulated:!0});this[e].push({event:c,focusTreeId:s,componentId:a,options:u})}(this._isFocusTreeRoot(a)||this.eventPropagationState.stopping)&&(this.keyEventManager.isGlobalListenersBound()||this[t]())}},{key:"simulatePendingKeyPressEvents",value:function(){this._simulatePendingKeyEvents("keypressEventsToSimulate","handleKeypress")}},{key:"simulatePendingKeyUpEvents",value:function(){this._simulatePendingKeyEvents("keyupEventsToSimulate","handleKeyup")}},{key:"_simulatePendingKeyEvents",value:function(e,r){var s=this;0<this[e].length&&fe.incrementId(),this[e].forEach(function(e){var t=e.event,n=e.focusTreeId,o=e.componentId,i=e.options;s[r](t,n,o,i)}),this[e]=[],this._clearEventPropagationState()}},{key:"_callHandlerIfActionNotHandled",value:function(e,t,n,o,i){this._describeCurrentKeyCombination();if(this.keyMapEventBitmap[n])if(this.eventPropagationState.actionHandled);else{var r=this.eventPropagationState.previousComponentPosition,s=this._getComponentPosition(o);this._callMatchingHandlerClosestToEventTarget(e,t,n,s,-1===r?0:r)&&(this.eventPropagationState.actionHandled=!0,this.currentEvent.handled=!0)}}},{key:"_logPrefix",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=S.logIcons,o=S.eventIcons,i=S.componentIcons,r="HotKeys (";if(!1!==t.focusTreeId){var s=w(t.focusTreeId)?this.focusTreeId:t.focusTreeId;r+="F".concat(s).concat(n[s%n.length],"-")}if(!1!==t.eventId){var a=w(t.eventId)?fe.getId():t.eventId;r+="E".concat(a).concat(o[a%o.length],"-")}r+="C".concat(e).concat(i[e%i.length]);var u=this._getComponentPosition(e);return w(u)||(r+="-P".concat(u).concat(i[u%i.length],":")),"".concat(r,")")}}]),o}();var Ce={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ie={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"};function Se(e){if(e.key){var t=Ce[e.key]||e.key;if("Unidentified"!==t)return t}if("keypress"!==e.type)return"keydown"===e.type||"keyup"===e.type?Ie[e.keyCode]||"Unidentified":"";var n,o,i,r=(i=(n=e).keyCode,"charCode"in n?0===(o=n.charCode)&&13===i&&(o=13):o=i,10===o&&(o=13),32<=o||13===o?o:0);return 13===r?"Enter":String.fromCharCode(r)}function we(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};return Array.isArray(e)||L(e)?n.stringifyFirst?!w(e.find(function(e){return e.toString()===t.toString()})):-1!==e.indexOf(t):ie(e)?T(e,t):n.stringifyFirst?e.toString()===t.toString():e===t}var Pe=function(e){function i(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=1<arguments.length?arguments[1]:void 0;return l(this,i),(e=g(this,d(i).call(this,t,n))).listenersBound=!1,e.eventOptions={ignoreEventsCondition:I.option("ignoreEventsCondition")},e}return p(i,ye),h(i,[{key:"enableHotKeys",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},o=3<arguments.length?arguments[3]:void 0,i=4<arguments.length?arguments[4]:void 0;this.eventOptions=i,this._addComponentToList(e,t,n,o),this._updateDocumentHandlers()}},{key:"updateEnabledHotKeys",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},o=3<arguments.length?arguments[3]:void 0,i=4<arguments.length?arguments[4]:void 0;this.eventOptions=i;var r=this._getComponentPosition(e);this.componentList[r]=this._buildComponentOptions(e,t,n,o),this._updateLongestKeySequenceIfNecessary(e),this._updateDocumentHandlers(),this._initHandlerResolutionState()}},{key:"disableHotKeys",value:function(e){var t,n,o=k(this._getComponentAndPosition(e),2),i=o[0].keyMapEventBitmap,r=o[1];this.componentList=(t=this.componentList,n=r,[].concat(m(t.slice(0,n)),m(t.slice(n+1)))),this._updateLongestKeySequenceIfNecessary(e),this._updateComponentIndexDictFromList({startingAt:r}),this._updateDocumentHandlers(i,P.newBitmap()),this._initHandlerResolutionState()}},{key:"_updateLongestKeySequenceIfNecessary",value:function(e){var n=this;e===this.longestSequenceComponentIndex&&(this.longestSequence=1,this.componentList.forEach(function(e){var t=e.longestSequence;t>n.longestSequence&&(n.longestSequence=t)}))}},{key:"_updateComponentIndexDictFromList",value:function(){for(var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{startingAt:0}).startingAt;e<this.componentList.length;)this._setComponentPosition(this.componentList[e].componentId,e),e++}},{key:"_updateDocumentHandlers",value:function(){var o=this,e=this.keyMapEventBitmap.some(function(e){return e});if(!this.listenersBound&&e){for(var t=function(e){var n=se(e);document["on".concat(n)]=function(e){var t;o.keyEventManager["handleGlobal".concat((t=n,t.replace(/\b\w/g,function(e){return e.toUpperCase()})))](e)}},n=0;n<this.keyMapEventBitmap.length;n++)t(n);this.listenersBound=!0}else if(this.listenersBound&&!e){for(n=0;n<this.keyMapEventBitmap.length;n++){var i=se(n);delete document["on".concat(i)]}this.listenersBound=!1}}},{key:"handleKeydown",value:function(e){this._checkForModifierFlagDiscrepancies(e);var t=ge(Se(e)),n=this._howReactAppRespondedTo(e,t,O.keydown);if(n!==me||!this.eventOptions.ignoreEventsCondition(e)){if(n!==_e)!!this._getCurrentKeyState(t)||this.keyCombinationIncludesKeyUp?this._startAndLogNewKeyCombination(t,O.keydown):this._addToAndLogCurrentKeyCombination(t,O.keydown);we([_e,Ee],n)||this._callHandlerIfExists(e,t,O.keydown),this._simulateKeyPressesMissingFromBrowser(e,t)}}},{key:"_howReactAppRespondedTo",value:function(e,t,n){var o=this.keyEventManager.reactAppHistoryWithEvent(t,n);switch(o){case Ee:case _e:case be:break;default:fe.incrementId()}return o}},{key:"handleKeypress",value:function(e){var t=ge(Se(e)),n=this._howReactAppRespondedTo(e,t,O.keypress);this._getCurrentKeyState(t)&&this._addToAndLogCurrentKeyCombination(t,O.keypress),n===me&&this.eventOptions.ignoreEventsCondition(e)||we([_e,Ee],n)||this._callHandlerIfExists(e,t,O.keypress)}},{key:"handleKeyup",value:function(e){var t=ge(Se(e)),n=this._howReactAppRespondedTo(e,t,O.keyup);this._getCurrentKeyState(t)&&this._addToAndLogCurrentKeyCombination(t,O.keyup),n===me&&this.eventOptions.ignoreEventsCondition(e)||we([_e,Ee],n)||this._callHandlerIfExists(e,t,O.keyup),this._simulateKeyUpEventsHiddenByCmd(e,t)}},{key:"_simulateKeyPressesMissingFromBrowser",value:function(e,t){this.keyEventManager.simulatePendingKeyPressEvents(),this._handleEventSimulation("handleKeypress",this._shouldSimulate(O.keypress,t),{event:e,key:t})}},{key:"_simulateKeyUpEventsHiddenByCmd",value:function(t,e){var n=this;ke(e)&&(this.keyEventManager.simulatePendingKeyUpEvents(),Object.keys(this._getCurrentKeyCombination().keys).forEach(function(e){ke(e)||n._handleEventSimulation("handleKeyup",n._shouldSimulate(O.keyup,e),{event:t,key:e})}))}},{key:"_startAndLogNewKeyCombination",value:function(e,t){this._startNewKeyCombination(e,t)}},{key:"_addToAndLogCurrentKeyCombination",value:function(e,t){this._addToCurrentKeyCombination(e,t)}},{key:"_handleEventSimulation",value:function(e,t,n){var o=n.event,i=n.key;if(t&&I.option("simulateMissingKeyPressEvents")){var r=this._cloneAndMergeEvent(o,{key:i,simulated:!0});this[e](r)}}},{key:"_callHandlerIfExists",value:function(e,t,n){this._describeCurrentKeyCombination();this.keyMapEventBitmap[n]&&this._callMatchingHandlerClosestToEventTarget(e,t,n)}},{key:"_callMatchingHandlerClosestToEventTarget",value:function(e,t,n){for(var o=0;o<this.componentList.length;o++){if(s(d(i.prototype),"_callMatchingHandlerClosestToEventTarget",this).call(this,e,t,n,o,0))return}}},{key:"_stopEventPropagation",value:function(e,t){e.simulated||e.stopPropagation()}},{key:"_logPrefix",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=S.eventIcons,o=S.componentIcons,i="HotKeys (GLOBAL";if(!1!==t.eventId){var r=w(t.eventId)?fe.getId():t.eventId;i="".concat(i,"-E").concat(r).concat(n[r%n.length])}return w(e)?"".concat(i,"):"):"".concat(i,"-C").concat(e).concat(o[e%o.length],"):")}}]),i}();function Oe(e){return!w(e)}var Me=function(){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};l(this,t),this.logger=e.logger||new S(I.option("logLevel")),this._focusOnlyEventStrategy=new Ke({configuration:e,logger:this.logger},this),this._globalEventStrategy=new Pe({configuration:e,logger:this.logger},this)}return h(t,null,[{key:"getInstance",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return this.instance||(this.instance=new t(e)),this.instance}},{key:"clear",value:function(){delete this.instance}}]),h(t,[{key:"getApplicationKeyMap",value:function(){return Object.assign(this._globalEventStrategy.getApplicationKeyMap(),this._focusOnlyEventStrategy.getApplicationKeyMap())}},{key:"registerKeyMap",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return this._focusOnlyEventStrategy.registerKeyMap(e)}},{key:"reregisterKeyMap",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};this._focusOnlyEventStrategy.reregisterKeyMap(e,t)}},{key:"deregisterKeyMap",value:function(e){this._focusOnlyEventStrategy.deregisterKeyMap(e)}},{key:"registerComponentMount",value:function(e,t){return this._focusOnlyEventStrategy.registerComponentMount(e,t)}},{key:"registerGlobalKeyMap",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return this._globalEventStrategy.registerKeyMap(e)}},{key:"registerGlobalComponentMount",value:function(e,t){return this._globalEventStrategy.registerComponentMount(e,t)}},{key:"reregisterGlobalKeyMap",value:function(e,t){this._globalEventStrategy.reregisterKeyMap(e,t)}},{key:"deregisterGlobalKeyMap",value:function(e){this._globalEventStrategy.deregisterKeyMap(e)}},{key:"enableHotKeys",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},o=3<arguments.length?arguments[3]:void 0;return this._focusOnlyEventStrategy.enableHotKeys(e,t,n,o)}},{key:"updateEnabledHotKeys",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{},i=4<arguments.length?arguments[4]:void 0;return this._focusOnlyEventStrategy.updateEnabledHotKeys(e,t,n,o,i)}},{key:"disableHotKeys",value:function(e,t){return this._focusOnlyEventStrategy.disableHotKeys(e,t)}},{key:"handleKeydown",value:function(e,t,n,o){if(Oe(t))return this._focusOnlyEventStrategy.handleKeydown(e,t,n,o)}},{key:"handleKeypress",value:function(e,t,n,o){if(Oe(t))return this._focusOnlyEventStrategy.handleKeypress(e,t,n,o)}},{key:"handleKeyup",value:function(e,t,n,o){if(Oe(t))return this._focusOnlyEventStrategy.handleKeyup(e,t,n,o)}},{key:"enableGlobalHotKeys",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},o=3<arguments.length?arguments[3]:void 0,i=4<arguments.length?arguments[4]:void 0;return this._globalEventStrategy.enableHotKeys(e,t,n,o,i)}},{key:"updateEnabledGlobalHotKeys",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},o=3<arguments.length?arguments[3]:void 0,i=4<arguments.length?arguments[4]:void 0;return this._globalEventStrategy.updateEnabledHotKeys(e,t,n,o,i)}},{key:"disableGlobalHotKeys",value:function(e){return this._globalEventStrategy.disableHotKeys(e)}},{key:"handleGlobalKeydown",value:function(e){return this._globalEventStrategy.handleKeydown(e)}},{key:"handleGlobalKeypress",value:function(e){return this._globalEventStrategy.handleKeypress(e)}},{key:"handleGlobalKeyup",value:function(e){return this._globalEventStrategy.handleKeyup(e)}},{key:"ignoreEvent",value:function(e){this._focusOnlyEventStrategy.ignoreEvent(e)}},{key:"forceObserveEvent",value:function(e){this._focusOnlyEventStrategy.forceObserveEvent(e)}},{key:"reactAppHistoryWithEvent",value:function(e,t){var n=this._focusOnlyEventStrategy.currentEvent;return n.key===e&&n.type===t?n.handled?Ee:n.ignored?_e:be:me}},{key:"simulatePendingKeyPressEvents",value:function(){this._focusOnlyEventStrategy.simulatePendingKeyPressEvents()}},{key:"simulatePendingKeyUpEvents",value:function(){this._focusOnlyEventStrategy.simulatePendingKeyUpEvents()}},{key:"isGlobalListenersBound",value:function(){return this._globalEventStrategy.listenersBound}}]),t}();function He(o){var e,t,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};function i(e,t){return b({},n[e]||{},t[e]||{})}function r(e){return i("handlers",e)}function s(e){return i("keyMap",e)}return t=e=function(e){function n(e){var t;return l(this,n),(t=g(this,d(n).call(this,e)))._handleFocus=t._handleFocus.bind(f(f(t))),t._handleBlur=t._handleBlur.bind(f(f(t))),t._handleKeyDown=t._handleKeyDown.bind(f(f(t))),t._handleKeyPress=t._handleKeyPress.bind(f(f(t))),t._handleKeyUp=t._handleKeyUp.bind(f(f(t))),t._componentIsFocused=t._componentIsFocused.bind(f(f(t))),t._id=Me.getInstance().registerKeyMap(e.keyMap),t}return p(n,u.PureComponent),h(n,[{key:"getChildContext",value:function(){return{hotKeysParentId:this._id}}},{key:"render",value:function(){var e=this.props,t=(e.keyMap,e.handlers,e.allowChanges,v(e,["keyMap","handlers","allowChanges"])),n={onFocus:this._wrapFunction("onFocus",this._handleFocus),onBlur:this._wrapFunction("onBlur",this._handleBlur),tabIndex:I.option("defaultTabIndex")};return this._shouldBindKeyListeners()&&(n.onKeyDown=this._handleKeyDown,n.onKeyPress=this._handleKeyPress,n.onKeyUp=this._handleKeyUp),c.createElement(o,y({hotKeys:n},t))}},{key:"_shouldBindKeyListeners",value:function(){var e=s(this.props);return!re(e)||I.option("enableHardSequences")&&this._handlersIncludeHardSequences(e,r(this.props))}},{key:"_handlersIncludeHardSequences",value:function(t,e){return Object.keys(e).some(function(e){return!t[e]&&te.isValidKeySerialization(e)})}},{key:"_wrapFunction",value:function(t,n){var o=this;return"function"==typeof this.props[t]?function(e){o.props[t](e),n(e)}:n}},{key:"_focusTreeIdsPush",value:function(e){this._focusTreeIds||(this._focusTreeIds=[]),this._focusTreeIds.push(e)}},{key:"_focusTreeIdsShift",value:function(){this._focusTreeIds&&this._focusTreeIds.shift()}},{key:"_getFocusTreeId",value:function(){if(this._focusTreeIds)return this._focusTreeIds[0]}},{key:"componentDidUpdate",value:function(e){var t=Me.getInstance();if(t.reregisterKeyMap(this._id,this.props.keyMap),this._componentIsFocused()&&(this.props.allowChanges||!I.option("ignoreKeymapAndHandlerChangesByDefault"))){var n=this.props,o=n.keyMap,i=n.handlers;t.updateEnabledHotKeys(this._getFocusTreeId(),this._id,o,i,this._getComponentOptions())}}},{key:"_componentIsFocused",value:function(){return!0===this._focused}},{key:"componentDidMount",value:function(){var e=Me.getInstance(),t=this.context.hotKeysParentId;e.registerComponentMount(this._id,t)}},{key:"_handleFocus",value:function(){var e;this.props.onFocus&&(e=this.props).onFocus.apply(e,arguments);var t=Me.getInstance().enableHotKeys(this._id,s(this.props),r(this.props),this._getComponentOptions());this._focusTreeIdsPush(t),this._focused=!0}},{key:"componentWillUnmount",value:function(){Me.getInstance().deregisterKeyMap(this._id),this._handleBlur()}},{key:"_handleBlur",value:function(){var e;this.props.onBlur&&(e=this.props).onBlur.apply(e,arguments);Me.getInstance().disableHotKeys(this._getFocusTreeId(),this._id)||this._focusTreeIdsShift(),this._focused=!1}},{key:"_handleKeyDown",value:function(e){Me.getInstance().handleKeydown(e,this._getFocusTreeId(),this._id,this._getEventOptions())&&this._focusTreeIdsShift()}},{key:"_handleKeyPress",value:function(e){Me.getInstance().handleKeypress(e,this._getFocusTreeId(),this._id,this._getEventOptions())&&this._focusTreeIdsShift()}},{key:"_handleKeyUp",value:function(e){Me.getInstance().handleKeyup(e,this._getFocusTreeId(),this._id,this._getEventOptions())&&this._focusTreeIdsShift()}},{key:"_getComponentOptions",value:function(){return{defaultKeyEvent:I.option("defaultKeyEvent")}}},{key:"_getEventOptions",value:function(){return{ignoreEventsCondition:I.option("ignoreEventsCondition")}}}]),n}(),_(e,"propTypes",{keyMap:a.object,handlers:a.object,onFocus:a.func,onBlur:a.func,allowChanges:a.bool}),_(e,"contextTypes",{hotKeysParentId:a.number}),_(e,"childContextTypes",{hotKeysParentId:a.number}),t}var Te=He(function(e){function t(){return l(this,t),g(this,d(t).apply(this,arguments))}return p(t,u.Component),h(t,[{key:"render",value:function(){var e=this.props,t=e.hotKeys,n=e.innerRef,o=e.component,i=v(e,["hotKeys","innerRef","component"]),r=o||I.option("defaultComponent");return c.createElement(r,b({},t,{ref:n},i))}}]),t}());Te.propTypes={innerRef:a.object};var Ae=function(e){function n(e){var t;return l(this,n),(t=g(this,d(n).call(this,e)))._id=Me.getInstance().registerGlobalKeyMap(e.keyMap),t}return p(n,u.Component),h(n,[{key:"getChildContext",value:function(){return{globalHotKeysParentId:this._id}}},{key:"render",value:function(){return this.props.children||null}},{key:"componentDidUpdate",value:function(){var e=Me.getInstance();if(e.reregisterGlobalKeyMap(this._id,this.props.keyMap),this.props.allowChanges||!I.option("ignoreKeymapAndHandlerChangesByDefault")){var t=this.props,n=t.keyMap,o=t.handlers;e.updateEnabledGlobalHotKeys(this._id,n,o,this._getComponentOptions(),this._getEventOptions())}}}]),h(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.keyMap,n=e.handlers,o=this.context.globalHotKeysParentId,i=Me.getInstance();i.registerGlobalComponentMount(this._id,o),i.enableGlobalHotKeys(this._id,t,n,this._getComponentOptions(),this._getEventOptions())}},{key:"componentWillUnmount",value:function(){var e=Me.getInstance();e.deregisterGlobalKeyMap(this._id),e.disableGlobalHotKeys(this._id)}},{key:"_getComponentOptions",value:function(){return{defaultKeyEvent:I.option("defaultKeyEvent")}}},{key:"_getEventOptions",value:function(){return{ignoreEventsCondition:I.option("ignoreEventsCondition")}}}]),n}();function xe(o){var e,t,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{only:[],except:[]},i=2<arguments.length?arguments[2]:void 0;return t=e=function(e){function n(e){var t;return l(this,n),(t=g(this,d(n).call(this,e)))._handleKeyEvent=t._handleKeyEvent.bind(f(f(t))),t._reloadDictionaries=t._reloadDictionaries.bind(f(f(t))),t}return p(n,u.PureComponent),h(n,[{key:"render",value:function(){var e=this.props,t=(e.only,e.except,v(e,["only","except"])),n={onKeyDown:this._handleKeyEvent,onKeyPress:this._handleKeyEvent,onKeyUp:this._handleKeyEvent,onFocus:this._reloadDictionaries};return c.createElement(o,y({hotKeys:n},t))}},{key:"_reloadDictionaries",value:function(){var e=this.props,t=e.only,n=e.except;this._onlyDict=De(t),this._exceptDict=De(n)}},{key:"_shouldIgnoreEvent",value:function(e){var t=e.key;return re(this._onlyDict)?!!re(this._exceptDict)||!this._exceptDict[t]:re(this._exceptDict)?this._onlyDict[t]:this._onlyDict[t]&&!this._exceptDict[t]}},{key:"_handleKeyEvent",value:function(e){this._shouldIgnoreEvent(e)&&Me.getInstance()[i](e)}}]),n}(),_(e,"propTypes",{only:a.oneOfType([a.string,a.arrayOf(a.string)]),except:a.oneOfType([a.string,a.arrayOf(a.string)])}),_(e,"defaultProps",n),t}function De(e){return ne(e).reduce(function(t,e){var n=q(e);if(!U(n))throw new N(e);return[ee,Z,H,D,J,Y].forEach(function(e){t[e(n)]=!0}),t},{})}_(Ae,"propTypes",{keyMap:a.object,handlers:a.object,allowChanges:a.bool}),Ae.contextTypes={globalHotKeysParentId:a.number},Ae.childContextTypes=Ae.contextTypes;var Be=xe(function(e){function t(){return l(this,t),g(this,d(t).apply(this,arguments))}return p(t,u.Component),h(t,[{key:"render",value:function(){var e=this.props,t=e.hotKeys,n=v(e,["hotKeys"]),o=n.component||I.option("defaultComponent");return c.createElement(o,b({},t,n))}}]),t}(),{},"ignoreEvent"),Le=xe(function(e){function t(){return l(this,t),g(this,d(t).apply(this,arguments))}return p(t,u.Component),h(t,[{key:"render",value:function(){var e=this.props,t=e.hotKeys,n=v(e,["hotKeys"]),o=n.component||I.option("defaultComponent");return c.createElement(o,b({},t,n))}}]),t}(),{},"forceObserveEvent");e.HotKeys=Te,e.GlobalHotKeys=Ae,e.IgnoreKeys=Be,e.ObserveKeys=Le,e.withHotKeys=He,e.withIgnoreKeys=function(e){return xe(e,1<arguments.length&&void 0!==arguments[1]?arguments[1]:{only:[],except:[]},"ignoreEvent")},e.withObserveKeys=function(e){return xe(e,1<arguments.length&&void 0!==arguments[1]?arguments[1]:{only:[],except:[]},"forceObserveEvent")},e.configure=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};I.init(e)},e.getApplicationKeyMap=function(){return Me.getInstance().getApplicationKeyMap()},Object.defineProperty(e,"__esModule",{value:!0})});
